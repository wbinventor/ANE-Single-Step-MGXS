%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Simulation Tools}
\label{sec:simulation-tools}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

This work employed both continuous energy and multi-group neutron transport codes. The OpenMC Monte Carlo code generated multi-group cross sections and reference solutions as discussed in \autoref{subsec:openmc}. The MGXS generated by OpenMC were used by the OpenMOC code for deterministic multi-group transport calculations as highlighted in \autoref{subsec:openmoc}.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Continuous Energy Calculations with OpenMC}
\label{subsec:openmc}

The OpenMC continuous energy Monte Carlo code was employed to generate multi-group cross sections, and reference eigenvalues and pin-wise fission and U-238 capture rates. The \texttt{openmc.mgxs} Python module \citep{boyd2018openmcmgxs} was used to tally multi-group cross sections in CASMO's seventy energy group structure \citep{rhodes2006casmo} from a single eigenvalue calculation. The MGXS were calculated with OpenMC's distributed cell tally algorithm \citep{lax2014distribcell}, which permits spatial tally zones across repeated cell instances. The OpenMC simulations were performed with 1000 batches with 10$^{6}$ particle histories per batch. Stationarity of the fission source was obtained with 100 inactive batches for both benchmarks.

The OpenMC simulations used the ``iso-in-lab'' feature to enforce isotropic in lab scattering. The ``iso-in-lab'' feature samples the outgoing neutron energy from the scattering laws prescribed by the continuous energy cross section library, but the outgoing neutron direction of motion is sampled from an isotropic in lab distribution. Although isotropic in lab scattering is a poor approximation for LWRs, it eliminated scattering source anisotropy as one possible cause of approximation error between OpenMC and OpenMOC. This simplification made it possible to isolate the approximation error resulting from the the pin-level spatial self-shielding scheme used to generate MGXS.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Multi-Group Calculations with OpenMOC}
\label{subsec:openmoc}

The OpenMOC code was employed for deterministic multi-group eigenvalue calculations with the MGXS generated by OpenMC. OpenMOC is a 2D method of characteristics code designed for fixed source and eigenvalue neutron transport calculations. OpenMOC approximates the scattering source as isotropic in the lab coordinate system, and discretizes the geometry into flat source regions (FSRs) which approximate the neutron source as constant across each spatial zone. The OpenMOC eigenvalue and energy-integrated, pin-wise reaction rates were compared with reference solutions computed by OpenMC.

Each OpenMOC simulation used a characteristic track laydown with 128 azimuthal angles and 0.05 cm spacing. All eigenvalue calculations were converged to 10$^{-5}$ on the root mean square of the energy-integrated fission source in each FSR. The Coarse Mesh Finite Difference (CMFD) acceleration scheme was employed on a pin-wise spatial mesh to reduce the number of iterations required to converge the fine-mesh transport calculations. The 70-group MGXS used for MOC were collapsed to a 14-group structure for CMFD to significantly improve the speed of the CMFD eigenvalue calculations.
