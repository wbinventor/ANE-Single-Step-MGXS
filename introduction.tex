%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}
\label{sec:intro}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Significant progress has been made in recent years to develop deterministic neutron transport-based tools for full-core reactor analysis \citep{gunow20173dmoc, ryu2015solution, kochunas2013overview, evans2010denovo, palmiotti2007unic}. These efforts are motivated by the desire to obtain Monte Carlo-quality solutions with computationally efficient multi-group methods. The focal point for much of this work has been the implementation and evaluation of parallel algorithms to make full-core analysis feasible on large computing machines. However, much work remains to develop methods for multi-group cross section (MGXS) generation that enable multi-group transport codes to achieve sufficient predictive accuracy to complement (or replace) analysis with continuous energy Monte Carlo methods.

Monte Carlo (MC) presents the most accurate method for reactor agnostic multi-group cross section generation since it does not require the use of any local approximations to the flux. This accuracy comes at the computational expense of converging group constant tallies to acceptably low uncertainties. It is increasingly common to use Monte Carlo to generate MGXS for coarse mesh diffusion \citep{serpent2013manual} and fine-mesh transport methods \citep{redmond1997multigroup, nelson2014improved, cai2014condensation}. The advantage of a MC-based approach is that all of the relevant physics are directly embedded into MGXS by weighting the continuous energy cross sections with a statistical proxy to the true neutron scalar flux. This paper replaces the traditional multi-step approach to MGXS generation with a single Monte Carlo eigenvalue calculation of the complete heterogeneous geometry to simultaneously account for all energy and spatial effects in a single step.

%Furthermore, the same MC calculation is used to compute a reference solution to benchmark the approximate solution from a multi-group code and to quantify the significance of spatially self-shielded MGXS.

%A two-pronged approach is needed to generate MGXS which enable Monte Carlo-quality solutions with multi-group methods. First, the approximation errors inherent to multi-group transport methods must be rigorously isolated and quantified by benchmarking multi-group transport with continuous energy Monte Carlo methods on fully-detailed heterogeneous benchmarks. These approximation errors may take on more (or less) relevance than they did for validation of the coarse-mesh multi-group diffusion-based codes used today. Second, the quantifiable results from these analyses should inform the development of solutions that rectify biases observed between multi-group and continuous energy transport methods.

This paper employs the single-step framework to investigate approximation error due to the effects of inter-pin spatial self-shielding in Pressurized Water Reactors (PWRs) on multi-group cross sections. The effects of neighboring pins, control rod guide tubes, burnable poisons and water reflectors are each of interest in the context of spatial self-shielding. In particular, this paper quantifies the difference in the approximation error between simulations in which the same MGXS are used for each unique fuel pin, and those in which unique MGXS are used in each \textit{instance} of each fuel pin throughout a core geometry. The former approach does little to model spatial self-shielding effects beyond those accounted for by an infinite fuel pin lattice model, while the latter goes much further to resolve inter-pin spatial self-shielding effects, albeit at the expense of much larger MGXS libraries. In addition, this paper introduces a technique to embed spatial self-shielding effects in MGXS by using geometric templates to spatially homogenize pin-wise reaction rates and fluxes tallied in each fuel pin instance. This technique analyzes a core geometry to predict which fuel pin instances have similar microscopic MGXS due to neighboring heterogeneities.

This paper is organized along two main themes. First, a single-step framework for reactor agnostic MGXS generation from Monte Carlo simulations is presented in \autoref{sec:single-step}. Second, three pin-wise spatial self-shielding models are introduced in \autoref{sec:pin-wise-shielding} to quantify approximation error. The single-step framework and pin-wise self-shielding models are empirically evaluated using continuous energy Monte Carlo simulations with OpenMC, and deterministic multi-group calculations with OpenMOC, as discussed in \autoref{sec:simulation-tools}. Two heterogeneous PWR benchmarks are presented in \autoref{sec:test-cases} to evaluate the efficacy of the self-shielding models in \autoref{sec:results}. Finally, the need for a more flexible approach to pin-wise spatial homogenization which captures spatial self-shielding effects with minimal human supervision is discussed in \autoref{sec:conclusions}.

